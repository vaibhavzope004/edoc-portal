:root {
            --bg: #f3f7ff;
            --surface: #ffffff;
            --line: #dbe6f7;
            --text: #1e293b;
            --muted: #64748b;
            --brand: #1d4ed8;
            --brand-2: #1e40af;
        }
        * { box-sizing: border-box; }
        body {
            font-family: "Manrope", sans-serif;
            margin: 0;
            color: var(--text);
            background:
                radial-gradient(circle at 10% 8%, #dbeafe 0%, transparent 28%),
                radial-gradient(circle at 92% 8%, #bfdbfe 0%, transparent 25%),
                var(--bg);
        }
        .topbar { background: linear-gradient(90deg, #2563eb, #1e40af); box-shadow: 0 10px 22px rgba(30, 64, 175, 0.24); }
        .topbar img { width: 100%; display: block; }
        .wrap { max-width: 1080px; margin: 26px auto; padding: 0 16px; }
        .title-row { display: flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 14px; }
        h2 { margin: 0; color: #1e3a8a; }
        h3 { margin: 0 0 14px; color: #1e40af; font-size: 1.15rem; }

        .msg { padding: 12px 14px; border-radius: 10px; margin-bottom: 12px; font-weight: 700; }
        .ok { background: #dcfce7; color: #166534; }
        .err { background: #fee2e2; color: #991b1b; }

        .grid { display: grid; grid-template-columns: 1fr; gap: 14px; }
        .card {
            background: var(--surface);
            border: 1px solid var(--line);
            border-radius: 14px;
            box-shadow: 0 10px 24px rgba(30, 41, 59, 0.08);
            padding: 18px;
        }
        .details-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px 18px;
        }
        .details-grid p { margin: 0; }
        .full { grid-column: 1 / -1; }
        .muted { color: var(--muted); }

        .field, .textarea {
            width: 100%;
            border: 1px solid #cbd5e1;
            border-radius: 9px;
            padding: 10px 12px;
            font: inherit;
        }
        .textarea { resize: vertical; min-height: 90px; }
        label { display: block; font-weight: 700; margin: 8px 0 6px; }
        .status-toolbar {
            display: grid;
            gap: 8px;
            grid-template-columns: minmax(200px, 320px) auto;
            align-items: end;
            margin-bottom: 12px;
        }

        .actions { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
        .btn {
            border: 0;
            border-radius: 10px;
            padding: 10px 14px;
            color: #fff;
            text-decoration: none;
            font-weight: 700;
            cursor: pointer;
            display: inline-block;
        }
        .btn-primary { background: linear-gradient(135deg, var(--brand), var(--brand-2)); }
        .btn-success { background: #15803d; }
        .btn-soft { background: #334155; }
        .btn-view { background: #1e40af; }
        .btn-sm { padding: 7px 10px; }

        .status-chip {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 999px;
            font-size: 0.84rem;
            font-weight: 800;
            letter-spacing: 0.3px;
        }
        .s-pending { color: #92400e; background: #fef3c7; }
        .s-applied { color: #1d4ed8; background: #dbeafe; }
        .s-success { color: #166534; background: #dcfce7; }
        .s-rejected { color: #991b1b; background: #fee2e2; }

        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 10px; border-bottom: 1px solid #e2e8f0; vertical-align: top; }
        th { background: #f8fafc; font-weight: 700; }
        .footer { margin-top: 20px; background: linear-gradient(90deg, #2563eb, #1e40af); color: #fff; padding: 14px; text-align: center; font-weight: 600; }
        .preview-overlay {
            position: fixed;
            inset: 0;
            z-index: 1200;
            background: rgba(15, 23, 42, 0.58);
            display: grid;
            place-items: center;
            padding: 16px;
            backdrop-filter: blur(1px);
        }
        .preview-window {
            width: min(1100px, 96vw);
            height: min(82vh, 760px);
            border-radius: 12px;
            border: 1px solid #bfdbfe;
            background: #ffffff;
            box-shadow: 0 24px 50px rgba(15, 23, 42, 0.42);
            overflow: hidden;
            display: grid;
            grid-template-rows: auto 1fr;
        }
        .preview-tabs {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #eff6ff;
            border-bottom: 1px solid #dbeafe;
            padding: 8px 10px;
        }
        .preview-tab {
            display: inline-block;
            padding: 8px 14px;
            border-radius: 8px 8px 0 0;
            background: #bfdbfe;
            color: #1e3a8a;
            font-weight: 800;
            letter-spacing: 0.2px;
        }
        .preview-tab.active {
            background: #1d4ed8;
            color: #ffffff;
        }
        .preview-actions {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .preview-icon-btn {
            width: 34px;
            height: 34px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            border: 1px solid #bfdbfe;
            background: #ffffff;
            color: #1e40af;
            text-decoration: none;
            font-size: 18px;
            font-weight: 700;
            line-height: 1;
            transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }
        .preview-icon-btn:hover {
            background: #dbeafe;
            border-color: #93c5fd;
            color: #1e3a8a;
        }
        .preview-icon-btn svg {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .preview-body {
            background: #f8fafc;
            height: 100%;
        }
        .preview-frame {
            width: 100%;
            height: 100%;
            border: 0;
            display: block;
            background: #f1f5f9;
        }

        @media (max-width: 760px) {
            .details-grid { grid-template-columns: 1fr; }
            .status-toolbar { grid-template-columns: 1fr; }
        }
